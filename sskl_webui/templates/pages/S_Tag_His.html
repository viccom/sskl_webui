<!DOCTYPE html>
<html lang="cn">
	<head>
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<meta charset="utf-8" />
		<title>电池平台</title>

		<meta name="description" content="frequently asked questions using tabs and accordions" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />

		<!-- bootstrap & fontawesome -->
		<link rel="stylesheet" href="/assets/sskl_webui/assets/css/bootstrap.min.css" />
		<link rel="stylesheet" href="/assets/sskl_webui/assets/font-awesome/4.5.0/css/font-awesome.min.css" />

		<!-- page specific plugin styles -->

		<!-- text fonts -->
		<link rel="stylesheet" href="/assets/sskl_webui/assets/css/fonts.googleapis.com.css" />

		<!-- ace styles -->
		<link rel="stylesheet" href="/assets/sskl_webui/assets/css/ace.min.css" class="ace-main-stylesheet" id="main-ace-style" />

		<!--[if lte IE 9]>
		<link rel="stylesheet" href="/assets/sskl_webui/assets/css/ace-part2.min.css" class="ace-main-stylesheet" />
		<![endif]-->
		<link rel="stylesheet" href="/assets/sskl_webui/assets/css/ace-skins.min.css" />
		<link rel="stylesheet" href="/assets/sskl_webui/assets/css/ace-rtl.min.css" />

		<!--[if lte IE 9]>
        <link rel="stylesheet" href="/assets/sskl_webui/assets/css/ace-ie.min.css" />
		<![endif]-->
        <link rel="stylesheet" href="/assets/sskl_webui/assets/css/ui.jqgrid.min.css" />
		<!-- inline styles related to this page -->

        <link type="text/css" rel="stylesheet" href="/assets/sskl_webui/assets/css/jquery.dataTables.min.css">
        <link type="text/css" rel="stylesheet" href="https://cdn.datatables.net/responsive/2.1.1/css/responsive.dataTables.min.css">

        <!--[if !IE]> -->
		<script src="/assets/sskl_webui/assets/js/jquery-2.1.4.min.js"></script>

		<!-- <![endif]-->
		<!--[if IE]>
		<script src="/assets/sskl_webui/assets/js/jquery-1.11.3.min.js"></script>

        <![endif]-->

		<script src="https://cdn.bootcss.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
		<script src="http://cdn.bootcss.com/datatables/1.10.15/js/jquery.dataTables.min.js"></script>
        <script src="/assets/sskl_webui/assets/js/jquery.dataTables.min.js"></script>
		<script src="/assets/sskl_webui/assets/js/jquery.dataTables.bootstrap.min.js"></script>
        <script src="https://cdn.datatables.net/responsive/2.1.1/js/dataTables.responsive.min.js"></script>

	</head>
	<body>
	<table width="100%" class="display responsive nowrap" id="example">
		<thead>
			<tr>
				<th>时间</th>
				<th>数值</th>
				<th>质量</th>
				<th>名称</th>
			</tr>
		</thead>

	</table>

<script>
    var sn = "{{sn}}";
    var vsn = "{{vsn}}";
    var tag = "{{tag}}";


$(document).ready(function() {
    var dataSet = [];

    var dataurl="";
      if(vsn!="None"){
        dataurl = "/api/method/sskl_webui.S_hisquery.taghisdata?sn="+sn+"&vsn="+vsn+"&condition=aa='"+tag.toLowerCase()+"'+and+time>now()+-+1m";
      }
      else{
        dataurl = "/api/method/sskl_webui.S_hisquery.taghisdata?sn="+sn+"&condition=aa='"+tag.toLowerCase()+"'+and+time>now()+-+1m";
      }
      //console.log(vsn, dataurl);

          var table = $('#example').DataTable( {
                "dom": 'lfrtp',

                "ajax": {
                    "url": dataurl,
                    "dataSrc": "message"
                },

                "columns": [

					{ "data": "time" },
					{ "data": "value" },
					{ "data": "quality" },
					{ "data": "name" },
                ],
        "columnDefs": [
            {
                "targets": [ 1 ],
                "visible": true

            },
            {
                "targets": [ 2 ],
                "visible": true
            }
        ]
            } );


    $.ajax({url:dataurl,async:true,success:function(r)
    {

		console.log(r);
        //################################################
        //console.log(symts.tags);

        //################################################

    },
        error : function() {
        console.log("SN或VSN错误");
        }
    });



} );
	</script>
	</body>
</html>
